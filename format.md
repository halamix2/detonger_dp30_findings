# Format description

Format generated by the CUPS filter:

* ignores white fields, just stops printing after all black pixels
* all commands begin with `1F`  (US, unit separator) and end with `88`

## Format

* `1F CC LL * 88`
  * starts with `1F`
  * `CC` - command
  * `LL` - length of data (*), without the ending `88` byte, EBV encoded
    * I use `EB` when there is only one EBV-encoded value
  * ends with `88`

### 0xc0 packing / EBV-encoding

If a number is greater or equal to 0xC0 (192), then  instead of using one byte to write data down two are used:

max `2^14-1` I guess

```C
data[0] = (byte)number;
data[1] = number >> 8 | 0xC0;
```

## known-ish commands

* `20 00` - " "
  * begin job, goes to the start of label
* `27 01 48` - "'"
  * set width in bytes? 0x48 = 72B = 576b
* `25 LL ?? ?? ?? ??` - "%" - package
  * two numbers of maxSFDots, maxLEDots
  * data EBV encoded
  * length always between 2-4 bytes
* `21 LL RR PP DD` - "!"
  * pushPrint
  * one line of an image
  * 2 numbers, then data
  * RR is number of line repetitions, RR+1 lines will be printed
  * PP is position, how many bytes were omitted at the start, so you can skip every 8 pixels
  * data is just bitmap of pixels, max 72 bytes
  * min 3 bytes, max 74
* `22 EB DD` `22 01 1B` - """
  * empty line
  * DD - number of empty lines minus 1
  * EBV encoded
* `28 00` - "("
  * end job
* `78 01 20` - "x"
  * dunno, unused by Linux driver
* `43 01 ??` - "C"
  * darkness
  * 0-14, which translates to darkness 1-15 on the printer
  * printer GUI only allows setting darkness between 6-15
* `44 01 ??` - "D"
  * speed
  * 0-4, which translates to speed 1-5 on the printer
* `42 01 ??` - "B"
  * gap info
  * 0 - continous
  * 1 - gap, or simply separate labels
  * 2 - gap, same as 1
  * 3 - black
* `45 EB ??` - "E"
  * if gap info 1-4
  * mm to Pix
  * gapInfo2
    * DPI * gapInfo2 / 25.4 + 0.5


## additonal setting not yet discovered

Printer have additional settigns which might be accessible from the format level

* auto feed  on, off
* motor speed: max, eco
* shutoff: 5/10/15/30min, 1/2/4/8h1
* notifiocation sounds: on, off
* language: english, chinese

## Typical job from Linux cups filter

```text
1F 20 00 88             -   begin job
1F 78 01 20 88          -   always the same, unknown
1F 27 01 48 88          -   page width in bytes (e.g. 72), confirmed
1F 25 ...               - max maxSFDots, maxLEDots
data..., 21/22 till the end
1F 28 00 88             - end job
```
